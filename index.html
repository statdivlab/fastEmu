<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fast Robust Score Tests for the Simplified Version of Model Implemented in radEmu • fastEmu</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Fast Robust Score Tests for the Simplified Version of Model Implemented in radEmu">
<meta property="og:description" content="Runs scalable robust score tests for the model implemented in radEmu.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">fastEmu</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/intro_to_fastEmu.html">Introduction to fastEmu</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="fastemu">fastEmu<a class="anchor" aria-label="anchor" href="#fastemu"></a>
</h1></div>
<!-- badges: start -->

<p><code>fastEmu</code> is an <code>R</code> package for estimating changes in the abundance of microbial categories (taxa, genes, etc.) associated with covariates using high throughput sequencing data. <code>fastEmu</code> is a wrapper for the package <a href="https://github.com/statdivlab/radEmu" class="external-link"><code>radEmu</code></a> that implements a fast version of the hypothesis testing procedure implemented in <code>radEmu</code>.</p>
<p>Check out <a href="https://github.com/statdivlab/radEmu" class="external-link"><code>radEmu</code></a> for a full list of reasons to use this method for your differential abundance analysis. Some highlights include:</p>
<ul>
<li>
<code>radEmu</code> uses high throughput sequencing data to estimate changes in the “absolute abundance” of categories</li>
<li>
<code>radEmu</code> doesn’t require data transformations, a reference taxon, or pseudocounts</li>
<li>
<code>radEmu</code> is robust to differential sampling depths and differential detection of categories (taxa, genes, etc.)</li>
<li>
<code>radEmu</code> has great error control, including in small samples and data generated from different distributions</li>
</ul>
<p>However, hypothesis testing in <code>radEmu</code> can be slow, especially when there is a large number of categories. This is why we created <code>fastEmu</code>! <code>fastEmu</code> uses a simplified model to test the same parameters* tested in <code>radEmu</code>, but much faster.</p>
<div class="section level3">
<h3 id="what-parameters-are-we-testing-exactly">What parameters are we testing exactly?<a class="anchor" aria-label="anchor" href="#what-parameters-are-we-testing-exactly"></a>
</h3>
<p>*We don’t estimate exactly the same parameters as in <code>radEmu</code>. In <code>radEmu</code>, we estimate the log fold difference in abundance associated with the covariate for each category <em>relative</em> to the typical log fold difference in abundance associated with the covariate across all categories. This lets us pick out the categories that are the most differentially abundant compared to the overall set of categories. In <code>fastEmu</code>, we cannot compare to the typical log fold difference all categories, because we need to reduce the size of our model in order to run it quickly. Instead, we compare to the typical log fold difference in a reference set of categories. The smaller the set, the faster the test will run.</p>
<p>You can either choose the reference set yourself (if you have a set of categories whose abundance you think varies little across covariate levels) or <code>fastEmu</code> can choose a data-driven reference set. This data-driven reference set is made up of the categories with the smallest estimated expected log fold difference across covariate levels relative to the typical log fold difference across the entire dataset. This means that the approximate median log fold difference within the reference set is very similar to the approximate median log fold difference within the full set of categories.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To download <code>fastEmu</code>, use the code below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"statdivlab/fastEmu"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/statdivlab/radEmu" class="external-link">radEmu</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="use">Use<a class="anchor" aria-label="anchor" href="#use"></a>
</h2>
<p>The vignettes demonstrate example usage of the main functions. Please <a href="https://github.com/statdivlab/fastEmu/issues" class="external-link">file an issue</a> if you have a request for a tutorial that is not currently included.</p>
<p>The following code will run <code>fastEmu</code> to estimate log fold differences in abundance for all categories in <code>Y</code> in comparison to the typical log fold difference in a data-driven reference set of categories (this parameter is nearly the same as the one estimated in <code>radEmu</code>). This code will then quickly run a robust score test for the hypothesis that the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mtext mathvariant="normal">th</mtext></mrow><annotation encoding="application/x-tex">5\text{th}</annotation></semantics></math> category has a log fold difference in abundance associated with the treatment that is different than the typical log fold difference associated with the treatment across categories in the reference set.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">emu_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fastEmuFit.html">fastEmuFit</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="op">~</span> <span class="va">treatment</span>,</span>
<span>                       data <span class="op">=</span> <span class="va">sample_data</span>, </span>
<span>                       Y <span class="op">=</span> <span class="va">count_data</span>,</span>
<span>                       test_kj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2</span>, j <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>                       reference_set <span class="op">=</span> <span class="st">"data_driven"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>We additionally have a <code>pkgdown</code> <a href="https://statdivlab.github.io/fastEmu/" class="external-link">website</a> that contains pre-built versions of our function <a href="https://statdivlab.github.io/fastEmu/reference/index.html" class="external-link">documentation</a> and a <a href="https://statdivlab.github.io/fastEmu/articles/intro_to_fastEmu.html" class="external-link">vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use <code>fastEmu</code> for your analysis, check back in soon for a preprint!</p>
</div>
<div class="section level2">
<h2 id="bug-reports--change-requests">Bug Reports / Change Requests<a class="anchor" aria-label="anchor" href="#bug-reports--change-requests"></a>
</h2>
<p>If you encounter a bug or would like make a change request, please file it as an issue <a href="https://github.com/statdivlab/fastEmu/intro_to_fastEmu" class="external-link">here</a>.</p>
<p>If you’re a developer, we would love to review your pull requests.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fastEmu</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Sarah Teichman <br><small class="roles"> Author, maintainer </small>   </li>
<li>Amy D Willis <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-2802-4317" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/statdivlab/fastEmu/actions" class="external-link"><img src="https://github.com/statdivlab/fastEmu/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/github/statdivlab/fastEmu" class="external-link"><img src="https://codecov.io/github/statdivlab/fastEmu/coverage.svg?branch=main" alt="codecov"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Sarah Teichman, Amy D Willis.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
